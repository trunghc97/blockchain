<div class="container">
  <mat-card>
    <mat-card-header>
      <mat-card-title>Ledger Viewer - {{contractId}}</mat-card-title>
    </mat-card-header>

    <mat-card-content>
      <div class="loading-spinner" *ngIf="loading">
        <mat-spinner></mat-spinner>
      </div>

      <div *ngIf="!loading">
        <mat-tab-group>
          <mat-tab label="Transactions">
            <table mat-table [dataSource]="transactions">
              <ng-container matColumnDef="id">
                <th mat-header-cell *matHeaderCellDef>Transaction ID</th>
                <td mat-cell *matCellDef="let tx">{{tx.id}}</td>
              </ng-container>

              <ng-container matColumnDef="type">
                <th mat-header-cell *matHeaderCellDef>Type</th>
                <td mat-cell *matCellDef="let tx">
                  <mat-chip [color]="getTransactionTypeColor(tx.type)" selected>
                    {{tx.type}}
                  </mat-chip>
                </td>
              </ng-container>

              <ng-container matColumnDef="approverID">
                <th mat-header-cell *matHeaderCellDef>Approver</th>
                <td mat-cell *matCellDef="let tx">{{tx.approverID || '-'}}</td>
              </ng-container>

              <ng-container matColumnDef="status">
                <th mat-header-cell *matHeaderCellDef>Status</th>
                <td mat-cell *matCellDef="let tx">{{tx.status}}</td>
              </ng-container>

              <ng-container matColumnDef="timestamp">
                <th mat-header-cell *matHeaderCellDef>Timestamp</th>
                <td mat-cell *matCellDef="let tx">{{tx.timestamp | date:'medium'}}</td>
              </ng-container>

              <tr mat-header-row *matHeaderRowDef="transactionColumns"></tr>
              <tr mat-row *matRowDef="let row; columns: transactionColumns;"></tr>
            </table>
          </mat-tab>

          <mat-tab label="Blocks">
            <table mat-table [dataSource]="blocks">
              <ng-container matColumnDef="blockNumber">
                <th mat-header-cell *matHeaderCellDef>Block Number</th>
                <td mat-cell *matCellDef="let block">{{block.blockNumber}}</td>
              </ng-container>

              <ng-container matColumnDef="timestamp">
                <th mat-header-cell *matHeaderCellDef>Timestamp</th>
                <td mat-cell *matCellDef="let block">{{block.timestamp | date:'medium'}}</td>
              </ng-container>

              <ng-container matColumnDef="hash">
                <th mat-header-cell *matHeaderCellDef>Hash</th>
                <td mat-cell *matCellDef="let block">
                  <code>{{block.hash}}</code>
                </td>
              </ng-container>

              <ng-container matColumnDef="previousHash">
                <th mat-header-cell *matHeaderCellDef>Previous Hash</th>
                <td mat-cell *matCellDef="let block">
                  <code>{{block.previousHash || '-'}}</code>
                </td>
              </ng-container>

              <ng-container matColumnDef="txIds">
                <th mat-header-cell *matHeaderCellDef>Transactions</th>
                <td mat-cell *matCellDef="let block">
                  <div class="tx-list">
                    <code *ngFor="let txId of block.txIds">{{txId}}</code>
                  </div>
                </td>
              </ng-container>

              <tr mat-header-row *matHeaderRowDef="blockColumns"></tr>
              <tr mat-row *matRowDef="let row; columns: blockColumns;"></tr>
            </table>
          </mat-tab>
        </mat-tab-group>
      </div>
    </mat-card-content>
  </mat-card>
</div>